<script>
  // Always detect production properly
  const IS_PROD = window.location.hostname.includes("shopsugarplum.co");

  // Backend base URL (NOT the frontend)
  const API_BASE = IS_PROD
    ? "https://sugarplum-backend.onrender.com"
    : "http://127.0.0.1:3000";

  document.addEventListener("DOMContentLoaded", () => {
    console.log("Thank-you: triggering post-checkout inventory refresh...");

    fetch(`${API_BASE}/admin/refresh-inventory`, {
      method: "POST",
      credentials: "include",
    })
      .then((res) => res.json())
      .then((data) => {
        console.log("Inventory refreshed after checkout:", data);
      })
      .catch((err) => {
        console.error("Auto inventory refresh failed:", err);
      });
  });
</script>
